# API网关流量安全

本文介绍API网关流量监控的告警规则，包括服务端响应时延过高、错误率过高和请求成功率过低。通过设置告警规则，可及时触发告警，有助于您快速发现API网关流量的安全问题。

## 告警规则列表

支持的告警规则列表如下所示。设置告警参数、设置白名单等相关操作，请参见[管理告警规则](/cn.zh-CN/应用中心（App）/日志审计服务/告警/管理告警规则.md)。

-   [API网关服务端平均延时过高告警](#section_nni_z6f_mcc)
-   [API网关后端服务器错误率过高告警](#section_e8r_vhx_16g)
-   [API网关请求成功率过低告警](#section_uvt_kqd_hqz)

## API网关服务端平均延时过高告警

|**告警ID**|sls\_app\_audit\_dataflow\_at\_api\_latency|
|**告警名称**|API网关服务端平均延时过高告警|
|**版本号**|1|
|**类别**|云平台、阿里云、流量安全、API网关流量安全|
|**作用**|监控API网关中的API请求的服务端平均延时。API网关中的API请求的服务端平均延时大于等于规则参数服务端平均延时阈值时，会触发告警。|
|**执行频率**|固定时间间隔：1分钟|
|**查询范围**|过去2分钟|
|**参数配置**|-   告警名称：告警实例的名称，默认为API网关服务端平均延时过高告警。您可以根据不同监控对象，命名不同的告警名称便于识别。
-   严重度：严重、高、中、低、报告。默认值为高。
-   服务端平均延时阈值：每2分钟内，API请求的服务端平均延时的最大值。默认值为100毫秒。
-   阿里云账号ID：需要监控的阿里云账号ID（支持正则）。
    -   多个阿里云账号ID之间可以使用竖线（\|）分隔。您还可以使用正则表达式`.*`进行配置，例如156133.\*，表示监控以156133开头的阿里云账号。
    -   默认值为`.*`，表示监控审计服务下配置的所有阿里云账号。
-   API名称：待监控的API名称（支持正则表达式）。默认值`.*`，表示监控所有API。 |
|**外部配置**|无|
|**消除方法**|检查服务端平均延时过高的API是否存在异常。|
|**前提条件**|确保已在日志审计服务中的**审计配置** \> **云产品接入** \> **全局配置**中打开API网关**访问日志**的开关。|

## API网关后端服务器错误率过高告警

|**告警ID**|sls\_app\_audit\_dataflow\_at\_api\_err\_rate|
|**告警名称**|API网关后端服务器错误率过高告警|
|**版本号**|1|
|**类别**|云平台、阿里云、流量安全、API网关流量安全|
|**作用**|监控API网关中API请求的后端服务器错误率。API网关中API请求的后端服务器错误率大于等于规则参数后端服务器错误率阈值时，会触发告警。|
|**执行频率**|固定时间间隔：1分钟|
|**查询范围**|过去2分钟|
|**参数配置**|-   告警名称：告警实例的名称，默认为API网关后端服务器错误率过高告警。您可以根据不同监控对象，命名不同的告警名称便于识别。
-   严重度：严重、高、中、低、报告。默认值为高。
-   后端服务器错误率阈值：每2分钟内，API请求的后端服务器错误率最大值。默认值为0%。
-   阿里云账号ID：需要监控的阿里云账号ID（支持正则）。
    -   多个阿里云账号ID之间可以使用竖线（\|）分隔。您还可以使用正则表达式`.*`进行配置，例如156133.\*，表示监控以156133开头的阿里云账号。
    -   默认值为`.*`，表示监控审计服务下配置的所有阿里云账号。
-   API名称：待监控的API名称（支持正则表达式）。默认值`.*`，表示监控所有API。 |
|**外部配置**|无|
|**消除方法**|检查后端服务器错误率过高的API是否存在异常。|
|**前提条件**|确保已在日志审计服务中的**审计配置** \> **云产品接入** \> **全局配置**中打开API网关**访问日志**的开关。|

## API网关请求成功率过低告警

|**告警ID**|sls\_app\_audit\_dataflow\_at\_api\_req\_rate|
|**告警名称**|API网关请求成功率过低告警|
|**版本号**|1|
|**类别**|云平台、阿里云、流量安全、API网关流量安全|
|**作用**|监控API网关中API的请求成功率。API网关的API请求成功率低于规则参数API请求成功率阈值时，会触发告警。|
|**执行频率**|固定时间间隔：1分钟|
|**查询范围**|过去2分钟|
|**参数配置**|-   告警名称：告警实例的名称，默认为API网关请求成功率过低告警。您可以根据不同监控对象，命名不同的告警名称便于识别。
-   严重度：严重、高、中、低、报告。默认值为高。
-   API请求成功率阈值：API请求的成功率最小值。默认值为95%。
-   阿里云账号ID：需要监控的阿里云账号ID（支持正则）。
    -   多个阿里云账号ID之间可以使用竖线（\|）分隔。您还可以使用正则表达式`.*`进行配置，例如156133.\*，表示监控以156133开头的阿里云账号。
    -   默认值为`.*`，表示监控审计服务下配置的所有阿里云账号。
-   API名称：待监控的API名称（支持正则表达式）。默认值`.*`，表示监控所有API。 |
|**外部配置**|无|
|**消除方法**|检查请求成功率过低的API是否存在异常。|
|**前提条件**|确保已在日志审计服务中的**审计配置** \> **云产品接入** \> **全局配置**中打开API网关**访问日志**的开关。|

