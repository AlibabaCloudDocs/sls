# 分析简介

日志服务提供分析功能，该功能结合了查询功能和SQL计算功能。本文介绍分析功能的基本语法、使用限制和SQL函数等信息。

**说明：**

-   如果您要使用分析功能，则必须在配置索引时打开对应字段的**开启统计**开关。更多信息，请参见[配置索引](/cn.zh-CN/查询与分析/配置索引.md)。 打开**开启统计**开关，可实现数据的秒级分析且无额外费用。
-   日志服务默认存在保留字段。如果您要分析保留字段，请参见[保留字段](/cn.zh-CN/产品简介/限制说明/保留字段.md)。

## 基础语法

查询语句和分析语句以竖线（\|）分割。查询语句可单独使用，分析语句必须与查询语句一起使用。即分析功能是基于查询结果或全量数据进行的。

**说明：**

-   分析语句中不需要填写FROM子句和WHERE子句，默认分析当前Logstore中的数据。
-   不需要在分析语句末尾加分号表示结束。
-   分析语句中不区分大小写。

-   基本语法

    ```
    查询语句|分析语句
    ```

    |语句类型|说明|
    |:---|:-|
    |查询语句|查询条件，可以为关键词、数值、数值范围、空格、星号（\*）等。 如果为空格或星号（\*），表示无过滤条件。更多信息，请参见[查询语法](/cn.zh-CN/查询与分析/查询语法与功能/查询语法.md)。 |
    |分析语句|对查询结果或全量数据进行计算和统计。|

-   示例

    ```
    * | SELECT status, count(*) AS PV GROUP BY status
    ```


## 使用限制

-   单个Project支持的最大分析操作并发数为15个。

    例如15个用户同时在同一个Project的各个Logstore中执行分析操作。

-   分析功能只对开启统计功能后写入的数据生效。

    如果您需要分析历史数据，请对历史数据重建索引。更多信息，请参见[重建索引](/cn.zh-CN/查询与分析/查询语法与功能/重建索引.md)。

-   执行分析操作后，默认最多返回100行数据。

    如果您需要返回更多数据，请使用LIMIT语法。更多信息，请参见[LIMIT语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/LIMIT语法.md)。

-   单个字段值最大长度为2KB，超出部分不参与分析。
-   分析操作的最大超时时间为55秒。
-   单个Shard仅支持分析1 GB数据量。
-   Double类型的字段值最多52位。

    如果浮点数编码位数超过52位，会造成精度损失。


## SQL函数和语法

日志服务支持以下SQL函数和语法。

-   SQL函数
    -   [通用聚合函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/通用聚合函数.md)
    -   [安全检测函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/安全检测函数.md)
    -   [Map映射函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/Map映射函数.md)
    -   [估算函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/估算函数.md)
    -   [数学统计函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/数学统计函数.md)
    -   [数学计算函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/数学计算函数.md)
    -   [字符串函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/字符串函数.md)
    -   [日期和时间函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/日期和时间函数.md)
    -   [URL函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/URL函数.md)
    -   [正则式函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/正则式函数.md)
    -   [JSON函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/JSON函数.md)
    -   [类型转换函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/类型转换函数.md)
    -   [IP地理函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/IP地理函数.md)
    -   [数组](/cn.zh-CN/查询与分析/SQL分析语法与功能/数组.md)
    -   [二进制字符串函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/二进制字符串函数.md)
    -   [位运算](/cn.zh-CN/查询与分析/SQL分析语法与功能/位运算.md)
    -   [同比和环比函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/同比和环比函数.md)
    -   [比较函数和运算符](/cn.zh-CN/查询与分析/SQL分析语法与功能/比较函数和运算符.md)
    -   [Lambda函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/Lambda函数.md)
    -   [逻辑函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/逻辑函数.md)
    -   [空间几何函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/空间几何函数.md)
    -   [地理函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/地理函数.md)
    -   [机器学习函数](/cn.zh-CN/查询与分析/机器学习语法与函数/概述.md)
    -   [窗口函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/窗口函数.md)
    -   [电话号码函数](/cn.zh-CN/查询与分析/SQL分析语法与功能/电话号码函数.md)
-   SQL语法
    -   [GROUP BY语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/GROUP BY语法.md)
    -   [ORDER BY语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/ORDER BY语法.md)
    -   [HAVING语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/HAVING语法.md)
    -   [LIMIT语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/LIMIT语法.md)
    -   [unnest语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/unnest语法.md)
    -   [insert语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/insert语法.md)
    -   [列的别名](/cn.zh-CN/查询与分析/SQL分析语法与功能/列的别名.md)
    -   [嵌套子查询](/cn.zh-CN/查询与分析/SQL分析语法与功能/嵌套子查询.md)
    -   [CASE WHEN和IF分支语法](/cn.zh-CN/查询与分析/SQL分析语法与功能/CASE WHEN和IF分支语法.md)

## 分析结果展示

您可以使用仪表盘展示分析结果，如下图所示：

![查询效果](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4764152161/p7348.png)

交互分析、仪表盘、Grafana、Datav等更多Demo信息，请单击[DEMO](http://logdemo.oss-cn-beijing.aliyuncs.com/)。

