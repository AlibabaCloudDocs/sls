# 配置开放告警对外接口

您可以在日志服务控制台上配置开放告警对外接口（创建开放告警服务和应用），用于接收外部监控系统中的告警消息。

## 步骤一：创建开放告警服务和应用

1.  登录[日志服务控制台](https://sls.console.aliyun.com)。

2.  进入开放告警管理页面。

    1.  在Project列表区域，单击任意一个Project。

    2.  在左侧导航栏中，单击**告警**。

    3.  单击**打开告警中心**，选择**告警管理** \> **开放告警**。

3.  创建开放告警服务。

    1.  单击**创建**。

    2.  在添加服务对话框中，配置开放告警服务的ID和名称，并单击**保存**。

4.  创建告警应用。

    1.  单击目标开放告警服务对应的**应用**。

    2.  在应用管理对话框中，单击**创建**。

    3.  在添加应用对话框中，配置如下参数，然后单击**保存**。

        |参数|说明|
        |--|--|
        |**ID**|告警应用的ID。|
        |**名称**|告警应用的名称。|
        |**协议认证**|
        |**协议**|用于定义告警消息的格式，可选值如下：        -   Prometheus告警：接收Prometheus告警。
        -   Grafana告警：接收Grafana告警。 |
        |**告警策略**|选择目标告警策略，用于合并、静默、抑制已产生的告警。更多信息，请参见[告警管理概述](/cn.zh-CN/告警（新版）/告警管理/概述.md)。关闭**高级选项**时，日志服务默认使用SLS内置动态告警策略进行告警处理。 |
        |**行动策略**|行动策略用于控制告警通知渠道和通知发送频率。更多信息，请参见[创建行动策略](/cn.zh-CN/告警（新版）/通知管理/创建行动策略.md)。**说明：** 在**告警策略**中关闭了**高级选项**或在创建告警策略时选择**行动策略**为**动态行动策略**时，此处的配置才有效。更多信息，请参见[动态行动策略机制](/cn.zh-CN/告警（新版）/告警管理/告警降噪控制/动态行动策略机制.md)。 |
        |**重复等待**|在重复等待时间内，重复的告警只触发一次行动策略，即日志服务只发送一次告警通知。|
        |**密钥ID白名单**|开启密钥ID白名单后，需添加阿里云访问密钥中的AccessKey ID。通过使用了该AccessKey ID的接口才能接入告警。例如您在此处配置AccessKey ID为**AEDC\*\*\*\*ERT**，您在Prometheus中将path\_prefix中的\{ACCESS\_KEY\_ID\}也配置为**AEDC\*\*\*\*ERT**，则表示对应的告警消息可被接入到日志服务告警系统中。

**说明：** 该访问密钥所属的RAM用户需具备AliyunLogOpenEventWrite权限。更多信息，请参见[附录：获取AccessKey ID](#section_v9z_jmt_d4y)。 |
        |**请求过滤**|
        |**关键字检查**|配置告警关键字后，开放告警系统仅接收告警消息中包含其中任意一个告警关键字的告警。|
        |**信息加工**|
        |**添加标签**|为告警消息添加标签信息，键值对格式。例如配置key为**环境**，value为**预发环境**。更多信息，请参见[标签](/cn.zh-CN/告警（新版）/告警监控/监控规则编排/标签和标注.md)。|
        |**添加标注**|为告警消息添加标注信息，键值对格式。例如配置key为**title**，value为**Prometheus告警**。更多信息，请参见[标注](/cn.zh-CN/告警（新版）/告警监控/监控规则编排/标签和标注.md)。**说明：** 此处配置的标注信息不支持使用模板变量。 |
        |**额度**|
        |**请求峰值控制**|用于控制告警应用每分钟可接收的告警消息数量。超过阈值后，告警消息被拒绝接入。取值范围：100次/分钟~10000次/分钟。|


## 步骤二：获取接口信息

您在Prometheus或Grafana端配置信息时，需使用该接口信息。

1.  在应用管理对话框中，单击目标应用对应的**接口**。

2.  在接口信息对话框中，选择告警消息接入的地域。

    **说明：** 如果您的Prometheus或运行在阿里云ECS上，则建议您在选择告警消息接入的地域时，选择ECS所在地域，并使用局域网或VPC接口。否则您选择任一地域的公网接口即可。

3.  将鼠标悬浮在文本框右侧的空白位置，复制完整URL、域名或子路径信息。

    其中，接口信息中的\{ACCESS\_KEY\_ID\}为阿里云访问密钥中的AccessKey ID，请根据实际情况替换。如何获取AccessKey ID，请参见[附录：获取AccessKey ID](#section_v9z_jmt_d4y)。

    ![接口信息](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9158869161/p267355.png)


## 附录：获取AccessKey ID

为保证账号安全，强烈建议您使用RAM用户进行告警接入操作，不要直接使用阿里云账号。用于告警接入的RAM用户需具备AliyunLogPutOpenEventPolicy权限。具体操作如下：

1.  创建RAM用户。具体操作，请参见[创建RAM用户](/cn.zh-CN/用户管理/创建RAM用户.md)。

2.  授予RAM用户AliyunLogPutOpenEventPolicy权限。具体操作，请参见[为RAM用户授权](/cn.zh-CN/用户管理/为RAM用户授权.md)。

3.  为RAM用户创建访问密钥（AccessKey ID）。具体操作，请参见[为RAM用户创建访问密钥](/cn.zh-CN/安全设置/访问密钥/为RAM用户创建访问密钥.md)。


-   [t2071251.md\#]()
-   [接入Grafana告警]()

