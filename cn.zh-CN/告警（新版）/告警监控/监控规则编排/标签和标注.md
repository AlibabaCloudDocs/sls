# 标签和标注

在创建告警监控规则时，您可以设置标签（labels）和标注（annotations）信息。标签主要应用于告警降噪、通知路由和管理分派等场景，标注主要应用于内容模板、管理分派等场景。

## 标签

标签主要有如下特征：

-   触发告警的标识性属性，键值对格式。告警指纹中的一部分，可用于告警去重。例如主机为host1，则其标签信息为"labels": \{"host": "host1"\}，告警管理系统可根据此标签进行告警去重。
-   您可在告警内容模板中通过`${labels}`引用标签信息。
-   在告警策略中，标签信息可作为降噪控制的合并基准。更多信息，请参见[合并基准](/cn.zh-CN/告警（新版）/告警管理/告警降噪控制/合并集合去重机制.md)。
-   告警管理系统和通知管理系统根据标签属性进行告警管理和通知分派。
-   您在分组评估中指定的字段可自动成为标签。
-   标签为静态文本，支持自定义标签。触发的告警会自动添加该标签为告警属性。

例如，在创建告警监控规则时，可以添加如下标签。

![biaoqian](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0924128161/p262329.png)

## 标注

标注主要有如下特征：

-   触发告警的非标识性属性，键值对格式，值可以是动态的。例如标注信息为"annotations": \{"title": "$\{service\} CPU使用率过高","desc": "$\{service\} CPU当前使用率为90%"\}。
-   您在配置标注内容时可引用分组评估中的字段变量，实际值为触发告警时对应的属性值。
-   告警管理系统和通知管理系统根据标注属性进行告警管理和通知分派。
-   固定有title和desc两个属性。
    -   title是告警固定的非标识性属性，可以在通知内容模板中以$\{annotations.title\}被引用。
    -   desc是告警固定的非标识性属性，可以在通知内容模板中以$\{annotations.desc\}被引用。

例如，在创建告警监控规则时，可以添加如下标注。

![biaozhu](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0924128161/p262331.png)

在标注的属性值中，可以使用如下内置变量：

|变量|说明|
|--|--|
|\_\_count\_\_|分组后每组的行数（不分组时，默认所有结果在一个组）|
|\_\_pass\_count\_\_|分组后每组满足条件的行数（不分组默认所有数据在一个组）|
|\_\_0\_count\_\_|第一个查询结果的行数|
|\_\_1\_count\_\_|第二个查询结果的行数|
|\_\_2\_count\_\_|第三个查询结果的行数|
|aliuid|阿里云账号ID|
|alert\_instance\_id|告警触发的实例的ID|
|alert\_id|告警规则ID|
|alert\_name|告警规则名称|
|project|告警规则所在Project|

## 自动标注

自动标注是对告警标注的补充。您在配置告警监控规则时，打开**自动添加标注**开关后，系统自动添加字段到到标注中。

**说明：**

-   当字段中存在多个值时，默认选择第一个值添加到标注中。
-   内置字段\_\_count\_\_表示集合操作结果的行数。

-   分组

    您在配置告警监控规则时，配置**分组评估**为**标签自定义**或**标签自动**，且打开**自动添加标注**开关，则系统自动将集合操作结果中的非分组字段和内置字段（\_\_count\_\_）添加到标注中。

    例如集合操作结果中包括host和pv，并且根据host字段进行分组，则开启标签自动添加功能后，pv字段和\_\_count\_\_字段将被添加到标注中。

    ![自动标注](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0382679161/p270207.png)

-   未分组

    您在配置告警监控规则时，配置**分组评估**为**不分组**，且打开**自动添加标注**开关，则系统自动将集合操作结果中的所有字段和内置字段（\_\_count\_\_）添加到标注中。

    例如集合操作结果中包括host和pv，则开启标签自动添加功能后，host字段、pv字段和\_\_count\_\_字段将被添加到标注中。

    ![不分组](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3266620261/p270443.png)


