# 设置告警

日志服务支持在查询分析页面或仪表盘页面设置告警，并在满足告警条件时发送告警信息。本文介绍如何在日志服务控制台上设置告警。

-   已采集到日志数据。
-   已[开启并配置索引](/cn.zh-CN/查询与分析/开启并配置索引.md)。

基于统计图表设置告警。您可以在查看图表时，将图表保存在仪表盘中，同时另存为告警，也可以在仪表盘页面中对已有的图表设置告警。

**说明：** 如果仪表盘中的图表绑定了告警规则，更新图表的查询分析语句后，需要手动更新告警规则，将告警规则中绑定的查询分析语句修改为更新后的语句。详情请参见[修改告警配置](/cn.zh-CN/可视化与告警/告警/管理告警配置.md#section_mp8_v5v_sp0)。

-   创建图表并设置告警

    在查询页面设置告警时，您需要指定图表保存到的仪表盘名称和图表名称。

    ![图表告警](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/1413813061/p43219.png)

-   在仪表盘页面对已有图表设置告警

    为仪表盘中的一个或多个图表设置告警。为多个图表设置告警时，可以设置组合触发条件。

    ![仪表盘告警](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3524008951/p5774.png)


常见告警配置案例请参见[告警配置案例](/cn.zh-CN/可视化与告警/告警/FAQ/如何在日志服务控制台中修改告警信息.md)。

## 操作步骤

本文以在仪表盘页面对已有图表设置告警为例。

1.  登录[日志服务控制台](https://sls.console.aliyun.com)。

2.  单击目标Project。

3.  在左侧导航栏中，单击![配置监控与告警-001](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/2453749951/p104975.png)，进入仪表盘列表。

4.  单击目标仪表盘。

5.  在页面右上角，单击**告警** \> **新建**。

6.  在告警配置页签中，设置告警规则并单击**下一步**。

    告警配置参数如下所示。

    |参数|说明|
    |:-|:-|
    |**告警名称**|告警名称，长度为1~64个字符。|
    |**关联图表**|设置告警中关联的图表。 支持添加多个图表，图表名称前的编号为该图表在告警中的编号，您可以在**触发条件**中通过编号指定关联的图表。

 单击查询语句后面的![编辑](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4524008951/p109887.png)，可修改查询语句。

 设置关联图表时，**查询区间**为日志服务每次执行查询时，读取数据的时间范围，支持相对时间与整点时间。例如，执行查询的时间点为14:30:06：

    -   设置**查询区间**为15分钟（相对），则实际查询区间为14:15:06-14:30:06。
    -   设置**查询区间**为15分钟（整点时间），则实际查询区间为14:15:00-14:30:00。 |
    |**频率**|日志服务每次执行告警检查的时间。 **说明：** 目前日志服务只检查查询结果中的前100条日志。 |
    |**触发条件**|判断是否触发告警的条件表达式，满足该条件时产生告警。 例如，设置为`pv%100 > 0 && uv > 0`。 **说明：** 触发条件中，通过$编号区分不同的关联图表，例如，$0表示编号为0的图表，详情请参见[如何查看图表编号](#section_kqs_ecc_0tr)。 |
    |**触发通知阈值**|累计触发次数达到该值时，根据通知间隔发送告警。不满足触发条件时不计入统计。 默认值为1，即满足一次触发条件就检查通知间隔。

 通过配置通知阈值可以实现多次触发，一次通知。例如，**触发通知阈值**为100，则累计触发次数达到100次时检查通知间隔，如果同时满足**触发通知阈值**和**通知间隔**，则发送通知。发送通知之后，累计次数会清零。如果因网络异常等原因执行检查失败，不计入累计次数。 |
    |**通知间隔**|两次告警通知之间的时间间隔。 如果某次查询符合触发条件，累计的触发次数达到**触发通知阈值**，且距离上次发送通知的时间已满足**通知间隔**，则发送通知。例如，通知间隔为5分钟，则5分钟内最多收到一次通知。

 **说明：** 通过配置触发通知阈值和通知间隔可以实现告警抑制的功能，防止收到过多的告警信息。 |

7.  在通知页签中，设置通知方式，并单击**提交**。

    通知方式包括短信、语音、邮件、WebHook-钉钉机器人、WebHook-自定义和通知中心。您可以执行多次添加，添加多种通知方式，你也可以单击**导入已有通知方式**，通知方式介绍与操作步骤请参见[通知方式](/cn.zh-CN/可视化与告警/告警/通知方式.md)。


## 常见问题

如何查看图表编号？

在**关联图表**中显示各个图表及查询语句的编号。其中第一个图表及查询语句编号为0，第二个图表及查询语句编号为1，第三个图表及查询语句编号为2。

![查看图表编号](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4524008951/p39405.png)

创建完成告警规则后，您可以[查看告警配置](/cn.zh-CN/可视化与告警/告警/管理告警配置.md)或[查看告警记录](/cn.zh-CN/可视化与告警/告警/查看告警记录.md)。

