# 按量付费

日志服务支持按量付费模式，按照实际的使用量进行收费。

## 计费说明

-   扣费周期：扣费周期为天，每天为您提供账单，按您当天的资源使用量进行收费。
-   免费额度：免费额度的周期为月，月底会清零。如您当月资源使用量在免费额度内，则不收费；如超出免费额度，则对超出部分收费。
-   数据投递：数据投递到OSS、MaxCompute、AnalyticDB、TSDB进行存储分析。该功能即将开始收费，详情请参见[（预告）新版预付资源包折扣策略说明](/intl.zh-CN/产品定价/（预告）新版预付资源包折扣策略及新商业化功能定价说明.md)。
-   数据加工：读取源Logstore与写入目标Logstore按照日志服务的收费标准正常收费，加工服务本身消耗的机器与网络资源即将进行收费，详情请参见[（预告）新版预付资源包折扣策略说明](/intl.zh-CN/产品定价/（预告）新版预付资源包折扣策略及新商业化功能定价说明.md)。

## 价格和免费额度

资源计费项及其单价见下表。

|资源计费项|价格|免费额度（每月）|
|:----|:-|:-------|
|[读写流量（压缩后）](#section_wfg_n5s_2fb)|0.045美元/GB|500 MB|
|[存储空间](#section_ezf_45s_2fb)|0.002875美元/GB\*天|500 MB|
|[索引流量](#section_gxd_p5s_2fb)|0.0875美元/GB|500 MB|
|**其他计费项**|
|[活跃Shard租用](#section_xbr_p5s_2fb)|0.01美元/天|31个\*天|
|[读写次数](#section_zxh_q5s_2fb)|0.03美元/百万次|1,000,000次|
|[外网读取流量](#section_nwv_q5s_2fb)|0.2美元/GB|无|

## 读写流量

-   读写流量根据压缩后的传输流量计算，通常情况下压缩率为10%~20%。
-   读写流量也包括通流式消费接口产生的读取流量，一般通过API/SDK、消费组SDK等进行操作。包括API/SDK方式在内，日志写入日志服务时均自动压缩。
-   对数据进行基于索引的查询、分析产生的流量免收读写流量费。例如通过控制台进行日志查询分析、报表和告警等流量不收费。

**说明：** 在日志服务的控制台中，**日志消费**下的**预览**功能也会产生微量流式消费流量。

示例：原始日志为10 GB，实际压缩后大小为1.5 GB，则以1.5 GB计费。

## 存储空间

存储空间为压缩后原始数据量与索引数据量之和。

示例：每天1 GB数据，压缩后为200 MB。其中10%的数据开启索引，大小为100 MB。存储周期为30天，则30天后累计最大存储量为30×（100+200）=9 GB，一天存储最大收费为0.002875×9≈0.026美元。

## 索引流量

-   索引默认为关闭状态，开启索引后产生索引流量才会计费。
-   索引流量根据实际索引字段进行计算，在写入时一次性收取费用。
-   对同时创建了全文索引（FullText）和字段索引（KeyValue）的字段，只计算一次流量。
-   建立索引后占用存储空间，所以会产生存储空间费用。

示例：10 GB日志中有10%字段需要查询，则流量只计算该部分，即产生索引流量费用0.0875美元。

## 活跃Shard租用

Shard租用只统计当前状态为readwrite的Shard数量。已经被合并或分裂的Shard不收取租用费。

一般每个Shard可以支持430 GB/天的数据写入量。

**示例**：当前有3个readwrite的Shard需要进行合并，合并后1个Shard的状态为读写，另外2个Shard被合并为只读，但今天仍会按照3个Shard进行计费体现在明天的账单中，明天则会按照新的合并进行计费并体现在后天的账单中，那么后天的账单会显示只收取1个Shard的租赁费0.01美元。

## 读写次数

日志写入日志服务的次数，由您的日志产生速度决定。后台实现机制会尽量减少读写次数。

示例：使用Logtail自动做批量发送，产生100万次写入，共计0.03美元。

## 外网读取流量

日志服务收集上来的日志数据被外网程序读取消费所产生的数据流量。

示例：2 G日志服务数据被投递至非阿里云产品，产生外网读取流量0.4美元。

## 计费示例

## 案例1：免费额度

假设您有3台服务器，一台服务器每天产生5 MB日志数据，您希望用程序对日志进行以下处理。

1.  实时查询，创建仪表盘进行在线运维。
2.  通过Java程序实时订阅日志处理。
3.  将日志投递至OSS。

收费明细：

-   资源：创建1个Logstore（1个Shard），单月共计31个，免费额度内。
-   读写流量：假设压缩率为20%，每天读写流量为15×20%（压缩后数据）×2（读+写）=6 MB（压缩后），单月累计6×31（天）=186 MB，免费额度内。
-   索引流量：15（原始数据）×31（天）=465 MB，免费额度内。
-   读写次数：一个月<100万次，免费额度内。

您每月不需要任何支出，就可免费使用日志服务进行线上日志分析与处理。

## 案例2：实时计算+离线计算

网站一天有1亿API请求，一个请求对应200字节日志，一天日志数量为20GB，高峰时流量为均值的5倍，则峰值流量为1.16 MB/s（<5 MB/s）。这些日志在日志服务保存2天，每天被读取一遍做实时计算，并导入到OSS中进行离线计算（Hive/Spark）。

收费明细：

-   活跃Shard租用：预留一个Shard，费用为0.01美元/天。
-   读写次数：使用Logtail自动做批量发送，产生100万次写入，费用为0.03美元。
-   读写流量：
    -   写入流量为20 GB，假设压缩率为10%，实际流量为2 GB，费用为2×0.045=0.09美元。
    -   实时计算读取流量和写入流量相同，0.09美元。
-   存储空间：存储大小为2 GB×2（Day）=4 GB，一天存储费用为4×0.002875=0.0115美元。
-   导入OSS部分免费。

一天的费用最多为0.01+0.03+0.09×2+0.0115=0.2315美元。

## 案例3：日志在线查询分析

服务一天有100万次API访问，一个请求对应200字节日志，一天的数据量为200 MB，保存最近30天的数据进行查询。

收费明细：

-   活跃Shard租用：预留一个Shard，费用为0.01美元/天。
-   读写次数：使用Logtail自动做批量发送，产生100万次写入，费用为0.03美元。
-   读写流量：写入流量为200 MB，压缩后0.05 G，则一天的读写流量费用为0.05×0.045=0.00225美元。
-   索引流量：一天索引费用为0.2×0.0875=0.0175美元。
-   存储空间：200 MB+50 MB（原始日志压缩）=250 MB，存储峰值为250×30=7.5 GB，一天的存储费用为7.5×0.002875=0.022美元。

一天的费用最多为0.01+0.03+0.00225+0.0175+0.022=0.08175美元。

